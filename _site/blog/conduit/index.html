<!doctype html> <!-- `site.alt_lang` can specify a language different from the UI --> <html lang="" data-mode="light"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"> <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"> <meta name="mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"> <meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><!-- Setup Open Graph image --> <!-- Begin Jekyll SEO tag v2.8.0 --> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="Building Conduit: A Scalable, Real-time messaging system" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="In this post, I’ll be going over the design and implementation of one of my recent projects, Conduit. Conduit is the messaging backend powering the AI Customer Support Platform, RhythmiqCX." /> <meta property="og:description" content="In this post, I’ll be going over the design and implementation of one of my recent projects, Conduit. Conduit is the messaging backend powering the AI Customer Support Platform, RhythmiqCX." /> <link rel="canonical" href="https://robinsharma.me/blog/conduit/" /> <meta property="og:url" content="https://robinsharma.me/blog/conduit/" /> <meta property="og:site_name" content="Robin Sharma" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2025-07-30T04:00:00+05:30" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Building Conduit: A Scalable, Real-time messaging system" /> <meta name="twitter:site" content="@Rabin_karp" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-07-30T04:00:00+05:30","datePublished":"2025-07-30T04:00:00+05:30","description":"In this post, I’ll be going over the design and implementation of one of my recent projects, Conduit. Conduit is the messaging backend powering the AI Customer Support Platform, RhythmiqCX.","headline":"Building Conduit: A Scalable, Real-time messaging system","mainEntityOfPage":{"@type":"WebPage","@id":"https://robinsharma.me/blog/conduit/"},"url":"https://robinsharma.me/blog/conduit/"}</script> <!-- End Jekyll SEO tag --> <title>Building Conduit: A Scalable, Real-time messaging system | Robin Sharma </title> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://realfavicongenerator.net/ --> <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"> <link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"> <meta name="apple-mobile-web-app-title" content="Robin Sharma"> <meta name="application-name" content="Robin Sharma"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> <!-- Resource Hints --> <link rel="preconnect" href="https://fonts.googleapis.com" > <link rel="dns-prefetch" href="https://fonts.googleapis.com" > <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link rel="dns-prefetch" href="https://fonts.gstatic.com" > <link rel="preconnect" href="https://cdn.jsdelivr.net" > <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" > <!-- Bootstrap --> <!-- Theme style --> <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"> <!-- Web Font --> <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"> <!-- Font Awesome Icons --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"> <!-- 3rd-party Dependencies --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"> <!-- Image Popup --> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <!-- Scripts --> <script src="/assets/js/dist/theme.min.js"></script> <!-- JS selector for site. --> <!-- commons --> <!-- layout specified --> <!-- image lazy-loading & popup & clipboard --> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js,npm/mermaid@11.4.0/dist/mermaid.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <!-- Pageviews --> <!-- PWA --> <!-- Web Analytics --> <!-- GoatCounter --> <script async src="https://gc.zgo.at/count.js" data-goatcounter="https://robin.goatcounter.com/count" ></script> <!-- A placeholder to allow defining custom metadata --> </head> <body> <!-- The Side Bar --> <aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"> <header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Robin Sharma</a> <p class="site-subtitle fst-italic mb-0">Software Developer</p> </header> <!-- .profile-wrapper --> <nav class="flex-column flex-grow-1 w-100 ps-0"> <ul class="nav"> <!-- home --> <li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a> </li> <!-- the real tabs --> <li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-laptop-code"></i> <span>BLOG</span> </a> </li> <!-- .nav-item --> <li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-user"></i> <span>CV</span> </a> </li> <!-- .nav-item --> </ul> </nav> <div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> </div> <!-- .sidebar-bottom --> </aside> <!-- #sidebar --> <div id="main-wrapper" class="d-flex justify-content-center"> <div class="container d-flex flex-column px-xxl-5"> <!-- The Top Bar --> <header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"> <div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" > <nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Building Conduit: A Scalable, Real-time messaging system</span> </nav> <!-- endof #breadcrumb --> <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button> <div id="topbar-title"> Post </div> <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button> </div> </header> <div class="row flex-grow-1"> <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"> <!-- Refactor the HTML structure --> <!-- In order to allow a wide table to scroll horizontally, we suround the markdown table with `<div class="table-wrapper">` and `</div>` --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --> <!-- Change the icon of checkbox --> <!-- Handle images --> <!-- Add header for code snippets --> <!-- Create heading anchors --> <!-- return --> <article class="px-1" data-toc="false"> <header> <h1 data-toc-skip>Building Conduit: A Scalable, Real-time messaging system</h1> <div class="post-meta text-muted"> <!-- published date --> <span> Posted <!-- Date format snippet See: ${JS_ROOT}/utils/locale-dateime.js --> <time data-ts="1753828200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 30, 2025 </time> </span> <!-- lastmod date --> <div class="d-flex justify-content-between"> <!-- author(s) --> <span> By <em> <a href="">Robin</a> </em> </span> <div> <!-- pageviews --> <!-- read time --> <!-- Calculate the post's reading time, and display the word count in tooltip --> <!-- words per minute --> <!-- return element --> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="623 words" > <em>3 min</em> read</span> </div> </div> </div> </header> <div class="content"> <p>In this post, I’ll be going over the design and implementation of one of my recent projects, <em>Conduit</em>.<br /> <em>Conduit</em> is the messaging backend powering the <a href="https://rhythmiqcx.com" target="_blank">AI Customer Support Platform</a>, <em>RhythmiqCX</em>.</p> <h2 id="messaging-primer"><span class="me-2">Messaging primer</span><a href="#messaging-primer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>For clients to send/receive messages over the internet, the two main architecture models are:</p> <ul> <li>Peer-to-Peer (P2P)</li> <li>Client-Server</li> </ul> <p>The <strong>Peer-to-Peer</strong> model has the obvious benefits of being decentralized, like <em>enhanced privacy</em>, <em>fault-tolerance</em> and no <a href="https://en.wikipedia.org/wiki/Single_point_of_failure" target="_blank">SPOF</a>. However, from a business SaaS point of view, where things like centralized authentication, access management, billing and more recently, AI Agents are must-haves, the <strong>Client-Server</strong> model takes center stage.</p> <h4 id="the-client-server-model"><span class="me-2">The Client-Server Model</span><a href="#the-client-server-model" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4> <p>From a rather crude perspective, the <strong>Client-Server</strong> model is implemented as below.</p><pre><code class="language-mermaid">flowchart LR
A(Alice)
B(Bob)
C((App Server))

A --&gt;|Hi! What's up?| C --&gt;|Hi! What's up?| B
</code></pre><p>When Alice hits send on her messaging app, the message is first routed to the App server, which, in no particular order:</p> <ul> <li>Authenticates the user.</li> <li>Checks necessary permissions.</li> <li>Applies filters for sensitive content.</li> <li>Persists the message to a database for durability.</li> <li>Bills the account</li> <li>And so on…</li> </ul> <p>And then finally routes the message to the intended recipient, Bob.</p> <h2 id="building-blocks"><span class="me-2">Building blocks</span><a href="#building-blocks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>Conduit is built using the following components.</p> <ul> <li>A highly-scalable messaging server at the core.</li> <li>A high-performance, async HTTP API.</li> <li>A robust relational database.</li> <li>A simple event poller/dispatcher.</li> </ul><pre><code class="language-mermaid">flowchart LR
subgraph conduit[Conduit]
A(Async HTTP API)
B((Messaging Server))
C[(Database)]
F(Event dispatcher)
end
</code></pre><p>Each component is implemented using <a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">FOSS</a> tools.</p> <h4 id="centrifugo"><span class="me-2"><a href="https://github.com/centrifugal/centrifugo" target="_blank">Centrifugo</a></span><a href="#centrifugo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4> <p><em>Centrifugo</em> is a real-time, pub/sub messaging server written in Go. It provides some very valuable features like:</p> <ul> <li>Real-time transports (WebSocket, SSE, gRPC etc.)</li> <li>Built-in horizontal scalability via <em>Redis</em></li> <li>Online Presence information</li> <li>JSON and protobuf support</li> </ul> <p><em>Centrifugo</em> powers the real-time message delivery for <em>Conduit</em> via it’s WebSocket transport. Users are subscribed to their own individual channels on app startup/login, so they can receive any messages published on that channel.</p> <h4 id="fastapi"><span class="me-2"><a href="https://github.com/fastapi/fastapi" target="_blank">FastAPI</a></span><a href="#fastapi" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4> <p><em>Conduit’s</em> HTTP API, used for sending messages is built using <em>FastAPI</em> due to it’s async capabilities coupled with Python’s simplicity.</p> <h4 id="postgresql"><span class="me-2"><a href="https://www.postgresql.org/" target="_blank">PostgreSQL</a></span><a href="#postgresql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4> <p><em>PostgreSQL</em> is the rightly-proclaimed “world’s most advanced open-source database”. No other database comes close in my opinion.</p> <h4 id="redis"><span class="me-2"><a href="https://redis.io/" target="_blank">Redis</a></span><a href="#redis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4> <p>At the moment, <em>Redis</em> is primarily used for scaling the <em>Centrifugo</em> cluster.</p> <h2 id="design"><span class="me-2">Design</span><a href="#design" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p><em>Conduit</em> is a <a href="https://en.wikipedia.org/wiki/Distributed_computing" target="_blank">distributed system</a> by nature and one of the (many) problems that arise when building distributed systems is when you have to update database state AND notify another service about it atomically. The two major patterns which attempt to solve this problem are <a href="https://microservices.io/patterns/data/transactional-outbox.html">The Transactional Outbox Pattern</a> and <a href="https://microservices.io/patterns/data/event-sourcing.html">The Event Sourcing Pattern</a>. <em>Conduit</em> implements the former.</p> <p>When we send a message using <em>Conduit’s</em> HTTP API, it is persisted in the database and a corresponding outbox event is created for it, in a single transaction. The event dispatcher, implementing <a href="https://microservices.io/patterns/data/polling-publisher.html">The Polling Publisher Pattern</a>, then reads events from the outbox and dispatches them to <em>Centrifugo</em> which delivers the messages in real-time to clients.</p> <h2 id="putting-it-all-together"><span class="me-2">Putting it all together</span><a href="#putting-it-all-together" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p>Let’s go back to our original example of Alice sending a message to Bob.</p> <p>Now with an app on their phones using <em>Conduit</em> as it’s messaging backend, a typical send message flow looks like this:</p> <ol> <li>Alice types out a text message for Bob and hits send.</li> <li>The app sends the message to <em>Conduit’s</em> HTTP API via a POST request.</li> <li><em>Conduit</em> authorizes the send request, persists the message AND the outbox event to the database, and returns a successful response.</li> <li>The event dispatcher picks up the new event in almost real-time (&lt; 300 ms) and sends it to the messaging server.</li> <li>The messaging server broadcasts the event to all channel subscribers over WebSockets.</li> </ol> <h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2> <p><em>Conduit</em> is still in relatively early stages and will probably go through major changes as new problems come up. If you made it this far, please make sure to check out <a href="https://rhythmiqcx.com" target="_blank">RhythmiqCX</a>, to experience <em>Conduit</em> in some real-time action!</p> </div> <div class="post-tail-wrapper text-muted"> <!-- categories --> <!-- tags --> <div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " > <div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author. </div> <!-- Post sharing snippet --> <div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span> </div> </div> <!-- .post-tail-bottom --> </div> <!-- div.post-tail-wrapper --> </article> </main> <!-- panel --> <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"> <div class="access"> <!-- Get 5 last posted/updated posts --> <section id="access-lastmod"> <h2 class="panel-heading">Recently Updated</h2> <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"> <li class="text-truncate lh-lg"> <a href="/blog/conduit/">Building Conduit: A Scalable, Real-time messaging system</a> </li> </ul> </section> <!-- #access-lastmod --> <!-- The trending tags list --> </div> </aside> </div> <div class="row"> <!-- tail --> <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post. --> <!-- The total size of related posts --> <!-- An random integer that bigger than 0 --> <!-- Equals to TAG_SCORE / {max_categories_hierarchy} --> <!-- Navigation buttons at the bottom of the post. --> <nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <div class="btn btn-outline-primary disabled" aria-label="Older"> <p>-</p> </div> <div class="btn btn-outline-primary disabled" aria-label="Newer"> <p>-</p> </div> </nav> <!-- The Footer --> <footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " > <p>© <time>2025</time> <em class="fst-normal">Robin</em>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span> </p> <p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.3.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>. </p> </footer> </div> </div> <!-- The Search results --> <div id="search-result-wrapper" class="d-flex justify-content-center d-none"> <div class="col-11 content"> <div id="search-hints"> <!-- The trending tags list --> </div> <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div> </div> </div> </div> <aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button> </aside> </div> <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div> <!-- Embedded scripts --> <!-- The comments switcher --> <!-- Jekyll Simple Search loader See: <https://github.com/christian-fei/Simple-Jekyll-Search> --> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: ' <article class="px-1 px-sm-2 px-lg-4 px-xl-0"> <header> <h2><a href="{url}">{title}</a></h2> <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags} </div> </header> <p>{content}</p> </article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script> </body> </html>
